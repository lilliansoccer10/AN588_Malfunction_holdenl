---
title: "What's Your Malfunction?"
author: "Lillian Holden"
date: "2023-10-23"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
install.packages("BSDA")
library(BSDA)
```

### Part 1

### Create Two Data Sets with Normal Distribution
```{r}
set.seed(0)
data.frame <- rnorm(50,5,1)
additional.data.frame <- rnorm(50,6,1)
```

> z.test

### Test that a One and Two Sample Z Test Works for the Data Sets
```{r}
z.test(data.frame, y=additional.data.frame, alternative='two.sided', mu=0, sigma.x=1, sigma.y=1,conf.level=.95)
```
### Create the Function
```{r}
z.prop.test <- 
```

```{r}
z.prop.test(data.frame, additional.data.frame)
```

### Part 2

```{r}
library(curl)
library(ggplot2)
```

### Import the Data Set
```{r}
f <- curl("https://raw.githubusercontent.com/fuzzyatelin/fuzzyatelin.github.io/master/AN588_Fall23/KamilarAndCooperData.csv")
d <- read.csv(f, header = TRUE, sep = ",", stringsAsFactors = FALSE) #Assign D as the vector for the data set
head(d)
```

### Plot the variables in a Scatterplot
```{r}
par(mfrow = c(1, 2))
plot(data=d, MaxLongevity_m ~ Brain_Size_Species_Mean)
plot(data=d, log(MaxLongevity_m) ~ log(Brain_Size_Species_Mean))
```

### Add A Fitted Line to the Scatterplots

```{r}
mI <- lm(MaxLongevity_m ~ Brain_Size_Species_Mean, data = d)
summary(mI)
mII <-  lm(log(MaxLongevity_m) ~ log(Brain_Size_Species_Mean), data = d)
summary(mII)
```

```{r}
par(mfrow = c(1, 2))
g <- ggplot(data = d, aes(x = Brain_Size_Species_Mean, y = MaxLongevity_m))
g <- g + geom_point()
g <- g + geom_smooth(method = "lm", formula = y ~ x)
g + annotate("text", x = 150, y = 800, label = "y=1.2180x + 248.9523")
h <- ggplot(data = d, aes(x = log(Brain_Size_Species_Mean), y = log(MaxLongevity_m)))
h <- h + geom_point()
h <- h + geom_smooth(method = "lm", formula = y ~ x)
h + annotate("text", x = 2, y = 6.5, label = "y=0.23415x +  4.87895")
```


### Identify and interpret the point estimate of the slope (β1), as well as the outcome of the test associated with the hypotheses H0: β1 = 0; HA: β1 ≠ 0. Also, find a 90 percent CI for the slope (β1) parameter.

- The estimate of the slope B1 for MaxLongevity_m ~ Brain_Size_Species_Mean is 1.2180. When B1 equals 0, y is equal to  248.9523. When B1 does not equal zero, it is the expected change in units of y for every 1 unit of change in x.

-The estimate of the slope B1 for log(MaxLongevity_m) ~ log(Brain_Size_Species_Mean) is 0.23415. When B1 equals 0, y is equal to
4.87895. When B1 does not equal zero, it is the expected change in units of y for every 1 unit of change in x.

### Find a 90% Confidence Interval Based on Each B1(m) Parameter
```{r}
ciI <- confint(mI, level = 0.90)  
ciI
ciII <- confint(mII, level = 0.90)  
ciII
```

```{r}
par(mfrow = c(1, 2))
g <- ggplot(data = d, aes(x = Brain_Size_Species_Mean, y = MaxLongevity_m))
g <- g + geom_point()
g <- g + geom_smooth(method = "lm", formula = y ~ x, colour = "black")
g <- g + geom_abline(intercept = 230.540738, slope = 1.035571, linewidth = 1, colour = "blue")
g <- g + geom_abline(intercept = 267.36379, slope = 1.40041, linewidth = 1, colour = "blue")
g + annotate("text", x = 150, y = 800, label = "y=1.2180x + 248.9523")
h <- ggplot(data = d, aes(x = log(Brain_Size_Species_Mean), y = log(MaxLongevity_m)))
h <- h + geom_point()
h <- h + geom_smooth(method = "lm", formula = y ~ x, colour = "black")
h <- h + geom_abline(intercept = 4.7644934, slope = 0.2046396, linewidth = 1, colour = "blue")
h <- h + geom_abline(intercept = 4.9934084, slope = 0.2636595, linewidth = 1, colour = "blue")
h + annotate("text", x = 2, y = 6.5, label = "y=0.23415x +  4.87895")
```

# I can't Figure out How to Make A Legend :( 

```{r}
cipredI <- predict(mI, newdata = data.frame(Brain_Size_Species_Mean = 800), interval = "confidence",
    level = 0.90) 
cipredI
```

I do trust the model to make that prediction because the fit was ~1223 with a 90% CI. The point is predicted to be between ~1089 and ~1357. When 800 is typed into the model equation alone y=1.2180x + 248.9523, it gets ~1223. 

